language: c

os:
  - linux

compiler:
  - gcc

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y bison flex

install:
  - ./install_bootstrap_compiler.sh "$HOME/mercury-bootstrap" mercury-srcdist-rotd-2018-05-23.tar.gz

env:
  - PATH="$PATH:$HOME/mercury-bootstrap/bin"

script:
  - ./prepare.sh
  - ./configure --prefix="$HOME/mercury-test" --with-default-grade=hlc.gc --enable-libgrades=hlc.gc
  - mmake
  - ./tools/bootcheck -G hlc.gc
